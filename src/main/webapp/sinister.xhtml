<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                template="/template/template.xhtml">

    <ui:param name="page_name" value="Accueil" />

    <ui:define name="menu">
        <head>
            <!-- Required meta tags-->

            <meta charset="UTF-8" />


            <!-- Title Page-->

            <title>Tables</title>
            <!-- Fontfaces CSS-->
            <link href="css/font-face.css" rel="stylesheet" media="all" />
            <link href="vendor/font-awesome-4.7/css/font-awesome.min.css" rel="stylesheet" media="all" />
            <link href="vendor/font-awesome-5/css/fontawesome-all.min.css" rel="stylesheet" media="all" />
            <link href="vendor/mdi-font/css/material-design-iconic-font.min.css" rel="stylesheet" media="all" />
            <!-- Bootstrap CSS-->
            <link href="vendor/bootstrap-4.1/bootstrap.min.css" rel="stylesheet" media="all" />
            <!-- Vendor CSS-->
            <link href="vendor/animsition/animsition.min.css" rel="stylesheet" media="all" />
            <link href="vendor/bootstrap-progressbar/bootstrap-progressbar-3.3.4.min.css" rel="stylesheet" media="all" />
            <link href="vendor/wow/animate.css" rel="stylesheet" media="all" />
            <link href="vendor/css-hamburgers/hamburgers.min.css" rel="stylesheet" media="all" />
            <link href="vendor/slick/slick.css" rel="stylesheet" media="all" />
            <link href="vendor/select2/select2.min.css" rel="stylesheet" media="all" />
            <link href="vendor/perfect-scrollbar/perfect-scrollbar.css" rel="stylesheet" media="all" />
            <!-- Main CSS-->
            <link href="css/theme.css" rel="stylesheet" media="all" />
        </head>

        <body class="animsition">
     <!-- PAGE CONTAINER-->

                <div class="page-container">
                   
                    <!-- MAIN CONTENT-->

                    <div class="main-content">

                        <div class="section__content section__content--p30">

                            <div class="container-fluid">


                                <div class="row">

                                    <div class="col-md-12">


                                        <!-- DATA TABLE -->

                                        <h3 class="title-5 m-b-35">The Sinisters</h3>
						<input type="text" class="form-control" placeholder="Search Type ..." id="searchrec" />
                                        <div class="table-responsive table-responsive-data2" id="entitiesNav">
                                           
                                            <h:panelGroup columns="2">
                                                <h:form>
                                                    <h:dataTable value="#{sinController.sinistres}" var="sinistre" border="1" styleClass="table table-data2">
                                            		<h:column>
											<f:facet name="header">
							<h:outputText value="Id " />
						</f:facet>
						<h:outputText value="#{sinistre.idSinistre}" />
					</h:column>
					<h:column>
						<f:facet name="header">
							<h:outputText value="Type Sinistre" />
						</f:facet>
						<h:outputText value="#{sinistre.typeSinistre}" />
					</h:column>
					<h:column>
						<f:facet name="header">
							<h:outputText value="Description" />
						</f:facet>
						<h:outputText value="#{sinistre.description}" />
					</h:column>
					<h:column>
						<f:facet name="header">
							<h:outputText value="Date d'Occurence" />
						</f:facet>
						<h:outputText value="#{sinistre.dateOccurence}" />
					</h:column>
					<h:column>
						<f:facet name="header">
							<h:outputText value="Status Sinistre" />
						</f:facet>
						<h:outputText value="#{sinistre.status}" />
					</h:column>
					<h:column>
						<f:facet name="header">
							<h:outputText value="Reglementation Sinistre" />
						</f:facet>
						<h:outputText value="#{sinistre.reglemntation}" />
					</h:column>
					<h:column>
						<f:facet name="header">
							<h:outputText value="Motif Sinistre" />
						</f:facet>
						<h:outputText value="#{sinistre.motifStatus}" />
					</h:column>
					<h:column>
						<f:facet name="header">
							<h:outputText value="AssurÃ©" />
						</f:facet>
						<h:outputText value="#{sinistre.user.firstName} #{sinistre.user.lastName}" />
					</h:column>
				<h:column>
						<f:facet name="header">
							<h:outputText value="Action" />
						</f:facet>
						<h:commandButton action="#{sinController.Calcul(sinistre.idSinistre)}" value="CVE" />
						
					</h:column>
					
					<h:column>
						<f:facet name="header">
							<h:outputText value="Action" />
						</f:facet>
						<h:commandButton action="#{sinController.updateStatus()}" value="update Status" />
						
					</h:column>
					<h:column>
						<f:facet name="header">
							<h:outputText value="Action" />
						</f:facet>
							<h:commandButton 
										value="Informations" action="#{sinController.informations(sinistre.idSinistre)}" />
						
					</h:column>
				
                                            
                                                    </h:dataTable>
                                                </h:form>
                                            </h:panelGroup>

                                        </div>
                                        <!-- END DATA TABLE -->
                                    </div>
                                </div>
                                                               
                            </div>
                        </div>
                    </div>
                </div>
            <!-- Jquery JS-->

            <script src="vendor/jquery-3.2.1.min.js"></script>
            <!-- Bootstrap JS-->

            <script src="vendor/bootstrap-4.1/popper.min.js"></script>

            <script src="vendor/bootstrap-4.1/bootstrap.min.js"></script>
            <!-- Vendor JS       -->

            <script src="vendor/slick/slick.min.js">
            </script>

            <script src="vendor/wow/wow.min.js"></script>

            <script src="vendor/animsition/animsition.min.js"></script>

            <script src="vendor/bootstrap-progressbar/bootstrap-progressbar.min.js">
            </script>

            <script src="vendor/counter-up/jquery.waypoints.min.js"></script>

            <script src="vendor/counter-up/jquery.counterup.min.js">
            </script>

            <script src="vendor/circle-progress/circle-progress.min.js"></script>

            <script src="vendor/perfect-scrollbar/perfect-scrollbar.js"></script>

            <script src="vendor/chartjs/Chart.bundle.min.js"></script>

            <script src="vendor/select2/select2.min.js">
            </script>
            <!-- Main JS-->
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
        <script type="text/javascript">
            jQuery(document).ready(function() {
                var searchRequest = null;
                $("#searchrec").keyup(function() {
                    var minlength = 0;
                    var that = this;
                    var value = $(this).val();
                    var entitySelector = $("#entitiesNav").html('');
                    if (value.length >= minlength ) {
                        if (searchRequest != null)
                            searchRequest.abort();
                        searchRequest = $.ajax({
                            type: "GET",
                            url: "{{ path('ajax_search') }}",
                            data: {
                                'q' : value
                            },
                            dataType: "text",
                            success: function(msg){
                                //we need to check if the value is the same
                                if (value===$(that).val()) {
                                    var result = JSON.parse(msg);
                                    $.each(result, function(key, arr) {
                                        $.each(arr, function(id, value) {
                                            if (key === 'entities') {
                                                if (id !== 'error') {
                                                    entitySelector.append('');
                                                } else {
                                                    entitySelector.append('');
                                                }
                                            }
                                        });
                                    });
                                }
                            }
                        });
                    }
                });
            });
        </script>
            <script src="js/main.js"></script>
            <!-- end document-->
        </body>
        
    </ui:define>
</ui:composition>